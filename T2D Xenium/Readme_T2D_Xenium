<h1><b>Analysis of T2D Xenium data</b></h1>

<h2><b>Step 1 Bulk RNA-seq data cleanup</b></h2>
<ul>
  <li>
    Download the bulkRNA_seq_Diabetes.csv file 
    <a href="https://github.com/dchatter04/DEGAS-Spatial-Smoothing/blob/main/T2D%20Xenium/bulkRNA_seq_Diabetes.csv">
      https://github.com/dchatter04/DEGAS-Spatial-Smoothing/blob/main/T2D%20Xenium/bulkRNA_seq_Diabetes.csv
    </a>
    into your local Drive.
  </li>
  <li>
    Run the lines in script BulkRNA-seq_datatcleanup.R 
    <a href="https://github.com/dchatter04/DEGAS-Spatial-Smoothing/blob/main/T2D%20Xenium/BulkRNA-seq_datacleanup.R">
      https://github.com/dchatter04/DEGAS-Spatial-Smoothing/blob/main/T2D%20Xenium/BulkRNA-seq_datacleanup.R
    </a>
  </li>
  <li>
    Preprocessed patient-level gene expression data will be stored as 
    <b>patDat.csv</b> and the labels of each patient
    whether they are classified as Type 2 Diabetic (t2d) or non-diabetic (no-diasese) is provided in 
    <b>patLab.csv</b> file.
  </li>
</ul>

<h2><b>Step 2 Preprocessing of the Xenium data (single cell spatially resolved transcriptomics (scSRT))</b></h2>
<ul>
  <li>
    Download the Type 2 Diabetes Xenium data for 4 tissue samples (2 type 2 diabetic, and 2 non-diabetic) from 
    <a href="https://www.synapse.org/Synapse:syn68699752/files/">
      https://www.synapse.org/Synapse:syn68699752/files/
    </a>
    into your local drive
  </li>
  <li>
    Run the lines in script <b>Preprocess_Xenium.R</b>
  </li>
  <li>
    Preprocessed combined gene expression data is stored as <b>stDat.rds</b> file.
  </li>
</ul>

<h2><b>Step 3 DEGAS model training and predictions</b></h2>
<ul>
  <li>
    Run the code <b>Model_training_and_prediction.R</b>
  </li>
  <li>
    Align the bulkRNA-seq and scSRT data with common set of highly variable genes and train the model. Save the trained model in 
    <b>model1.RDS</b> file.
  </li>
  <li>
    Obtain the saved patient -level predictions in <b>preds1.csv</b> file.
  </li>
</ul>

<h2><b>Step 4 Postprocessing smoothing</b></h2>
<ul>
  <li>
    Run the code <b>SwiS_smoothing.R</b>
  </li>
  <li>
    Sliding Window (<b>swSmoothAtlas</b>) function is provided in the list of functions document.
  </li>
  <li>
    Smoothed predictions for each sample is individually stored in 
    <b>swSmoothed_ND1.rds</b>, <b>swSmoothed_T2D1.rds</b>, <b>swSmoothed_ND2.rds</b>, and <b>swSmoothed_T2D2.rds</b> respectively.
  </li>
</ul>

<h2><b>Step 5 Other relevant plots</b></h2>
<ul>
  <li>
    Run the script <b>Plots.R</b> for the relavant boxplots and the pairwise Wilcoxon test results for DEGAS prediction scores for non-diabetic vs type 2 diabetic samples.
  </li>
</ul>
